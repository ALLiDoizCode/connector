# Staging Overlay for M2M Connector (TESTNET)
#
# This overlay configures the connector for TESTNET deployment with:
#   - Base Sepolia (testnet)
#   - XRP Testnet
#   - Aptos Testnet
#   - Debug logging enabled
#
# Usage:
#   kubectl apply -k k8s/connector/overlays/staging
#
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

namespace: agent-runtime-staging

resources:
  - ../../base

# Override namespace for staging
nameSuffix: -staging

# Staging ConfigMap patches - TESTNET URLs
patches:
  - patch: |
      apiVersion: v1
      kind: ConfigMap
      metadata:
        name: connector-config
      data:
        # Network Mode
        NETWORK_MODE: "testnet"
        # Testnet RPC URLs
        BASE_L2_RPC_URL: "https://sepolia.base.org"
        BASE_RPC_URL: "https://sepolia.base.org"
        XRPL_WSS_URL: "wss://s.altnet.rippletest.net:51233"
        APTOS_NODE_URL: "https://fullnode.testnet.aptoslabs.com/v1"
        # Staging settings
        ENVIRONMENT: "staging"
        LOG_LEVEL: "debug"
        SETTLEMENT_ENABLED: "true"
    target:
      kind: ConfigMap
      name: connector-config

# Staging image
images:
  - name: agent-runtime/connector
    newTag: staging

commonAnnotations:
  environment: staging
  network-mode: testnet
