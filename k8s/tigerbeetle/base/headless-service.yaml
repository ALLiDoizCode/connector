# TigerBeetle Headless Service
# Provides stable DNS names for StatefulSet pods:
#   - tigerbeetle-0.tigerbeetle-headless.tigerbeetle.svc.cluster.local
#   - tigerbeetle-1.tigerbeetle-headless.tigerbeetle.svc.cluster.local
#   - tigerbeetle-2.tigerbeetle-headless.tigerbeetle.svc.cluster.local
#
# These DNS names are used for inter-replica communication and consensus.
apiVersion: v1
kind: Service
metadata:
  name: tigerbeetle-headless
  namespace: tigerbeetle
  labels:
    app.kubernetes.io/name: tigerbeetle
    app.kubernetes.io/component: accounting-database
spec:
  clusterIP: None  # Headless service
  publishNotReadyAddresses: true  # Required for initial cluster formation
  selector:
    app.kubernetes.io/name: tigerbeetle
  ports:
    - name: tigerbeetle
      port: 3000
      targetPort: 3000
      protocol: TCP
