# Production Environment Configuration Template
#
# This is a template for production secrets and configuration.
# CRITICAL SECURITY INSTRUCTIONS:
#   1. Copy this file to .env: cp .env.production.example .env
#   2. Edit .env with your actual production values
#   3. NEVER commit .env file to git (it's in .gitignore)
#   4. Keep .env file permissions restricted: chmod 600 .env
#   5. Rotate secrets regularly in production
#
# This file (.env.production.example) is committed to git as a template.
# The actual .env file with real secrets should NEVER be committed.

# ===========================
# Node Configuration
# ===========================

# Connector identifier (must match nodeId in YAML config)
NODE_ID=production-connector

# Log level for production (info, warn, error)
# Do not use debug in production (too verbose)
LOG_LEVEL=info

# ===========================
# Network Ports
# ===========================

# BTP server port (exposed to host for incoming connections)
BTP_PORT=3000

# Health check HTTP port (internal only, not exposed to host)
HEALTH_CHECK_PORT=8080

# ===========================
# TigerBeetle Configuration
# ===========================
#
# TigerBeetle is a distributed accounting database used for settlement layer
# tracking. It maintains double-entry bookkeeping ledgers for peer balances
# with ACID guarantees and microsecond-level latency.
#
# CRITICAL: Cluster ID is IMMUTABLE after initialization
# Once set, changing TIGERBEETLE_CLUSTER_ID requires reformatting (DATA LOSS)

# TigerBeetle cluster ID (unique per deployment)
# Default: 0 (suitable for single deployment)
# IMPORTANT: Must be unique if running multiple independent clusters
# NEVER change this value after first initialization
TIGERBEETLE_CLUSTER_ID=0

# TigerBeetle replica count (number of nodes in the cluster)
# Development: 1 (single-node, no replication)
# Production: 3 or 5 (odd number required for quorum consensus)
# IMPORTANT: Replica count should be odd (1, 3, 5) for majority quorum
# More replicas = higher availability but slower writes
TIGERBEETLE_REPLICA_COUNT=1

# TigerBeetle client connection port (internal Docker network only)
# Default: 3000 (TigerBeetle standard port)
# SECURITY: This port should NOT be exposed to host (internal network only)
# Connectors access TigerBeetle via Docker hostname: tigerbeetle:3000
TIGERBEETLE_PORT=3000

# TigerBeetle data directory inside container
# Default: /data (TigerBeetle convention)
# Do not change unless you have a specific reason
# Data is persisted via Docker volume: tigerbeetle-data
TIGERBEETLE_DATA_DIR=/data

# ===========================
# Settlement Configuration
# ===========================
#
# Credit limits manage counterparty risk by limiting how much peers can owe
# the connector before packets are rejected. This prevents unbounded exposure
# to peers who fail to settle or act maliciously.

# Global credit limit ceiling (optional, security safety valve)
# Maximum allowed credit limit per peer regardless of per-peer configuration
# Prevents misconfiguration from creating unbounded exposure
# Format: Integer amount in smallest currency units
# Examples:
#   SETTLEMENT_GLOBAL_CREDIT_CEILING=1000000     # 1M units max per peer
#   SETTLEMENT_GLOBAL_CREDIT_CEILING=1000000000  # 1B units max per peer
# Leave empty for no global ceiling (use configured limits only)
# IMPORTANT: This is a safety override - configured limits higher than this
# value will be reduced to the ceiling
SETTLEMENT_GLOBAL_CREDIT_CEILING=

# Credit Limit Usage Notes:
#
# - Credit limits are configured per-peer in connector YAML config
# - Global ceiling applies to ALL peers as security override
# - Undefined/empty = no global ceiling (use configured limits only)
# - Ceiling should be set based on your maximum acceptable exposure
# - Example: If you can afford to lose 10M units total, set ceiling=10000000
# - Credit limits prevent peers from building up debt beyond configured threshold
# - Packets rejected with T04_INSUFFICIENT_LIQUIDITY when limit exceeded
# - Peers must settle (reduce debt) before sending more packets

# Production Deployment Notes:
#
# 1. Multi-Replica Setup (Production):
#    - Set TIGERBEETLE_REPLICA_COUNT=3 (or 5 for higher availability)
#    - Deploy 3 separate TigerBeetle containers with unique replica IDs
#    - Configure cluster addresses for all replicas
#    - See docs/guides/tigerbeetle-deployment.md for detailed instructions
#
# 2. Cluster ID Management:
#    - Cluster ID is immutable after initialization
#    - Each independent deployment needs unique cluster ID
#    - Changing cluster ID requires reformatting (ALL DATA LOST)
#    - Document your cluster ID in production runbooks
#
# 3. Backup Strategy:
#    - Regularly backup Docker volume: tigerbeetle-data
#    - Test backup restoration procedures
#    - Consider point-in-time snapshots before major changes
#    - Future: Implement automated backup solution
#
# 4. Security Considerations:
#    - TigerBeetle port should NOT be exposed to public internet
#    - Use Docker network isolation (ilp-network bridge)
#    - Currently no authentication (relies on network-level access control)
#    - Future: May add TLS or authentication layer for production
#
# 5. Monitoring:
#    - Watch health check status: docker inspect tigerbeetle --format '{{.State.Health.Status}}'
#    - Monitor logs: docker-compose logs -f tigerbeetle
#    - Track disk space for data volume
#    - Future: StatsD metrics integration for production monitoring

# ===========================
# Optional Services
# ===========================

# Dashboard telemetry WebSocket URL (optional)
# Leave empty to disable dashboard telemetry in production
# Example: ws://dashboard-host:9000
DASHBOARD_TELEMETRY_URL=

# If dashboard is enabled, configure its ports:
# DASHBOARD_HTTP_PORT=8080
# DASHBOARD_WS_PORT=9000

# ===========================
# BTP Peer Authentication Secrets
# ===========================
#
# CRITICAL: Use strong random secrets for BTP peer authentication
# Generate secrets with: openssl rand -base64 32
#
# Pattern: BTP_PEER_<PEER_ID_UPPERCASE>_SECRET=<secret_value>
# The PEER_ID must match the peer ID in your YAML config (converted to uppercase)
#
# Examples:
# If your YAML has peer with id: "remote-connector", use:
# BTP_PEER_REMOTE_CONNECTOR_SECRET=your-secret-here
#
# If your YAML has peer with id: "peer-1", use:
# BTP_PEER_PEER_1_SECRET=your-secret-here
#
# Multiple peers example:
# BTP_PEER_PEER_1_SECRET=generate-with-openssl-rand-base64-32
# BTP_PEER_PEER_2_SECRET=generate-with-openssl-rand-base64-32
# BTP_PEER_BACKUP_CONNECTOR_SECRET=generate-with-openssl-rand-base64-32

# Add your BTP peer secrets below (replace with actual values):
# BTP_PEER_REMOTE_CONNECTOR_SECRET=

# ===========================
# Security Best Practices
# ===========================
#
# 1. Generate Strong Secrets:
#    openssl rand -base64 32
#
# 2. Restrict File Permissions:
#    chmod 600 .env
#
# 3. Rotate Secrets Regularly:
#    Update secrets periodically (e.g., every 90 days)
#    Use different secrets for each peer connection
#
# 4. Never Commit Secrets:
#    Verify .env is in .gitignore before committing
#    Use git secrets scanning tools if available
#
# 5. Environment-Specific Secrets:
#    Use different secrets for staging/production
#    Never reuse development secrets in production
#
# 6. Secure Storage:
#    Consider using secret management tools (Vault, AWS Secrets Manager, etc.)
#    For this MVP, .env file with chmod 600 is acceptable
