<!-- Powered by BMAD™ Core -->

# Story 3.1: Create React Dashboard Application with Routing

## Status

Done

## Story

**As a** developer,
**I want** a React application scaffold with routing and basic layout,
**so that** I can build the visualization dashboard UI.

## Acceptance Criteria

1. React 18+ application initialized in `packages/dashboard` with TypeScript and Vite build tool
2. TailwindCSS configured for styling with dark theme as default
3. React Router configured (even if single-page for MVP, structure for future expansion)
4. Main layout component created with header (app name, version) and content area
5. Basic responsive layout works on desktop resolutions (1366x768 to 1920x1080+)
6. Application builds successfully with `npm run build` and dev server runs with `npm run dev`
7. Production build assets optimized (code splitting, minification)
8. Dashboard Dockerfile created to serve built React app via nginx or Node.js static server
9. Dashboard service added to docker-compose.yml accessible at http://localhost:8080
10. README documentation updated with instructions to access dashboard

## Tasks / Subtasks

**Task Execution Strategy:** This story establishes the foundational React application structure for the dashboard. Tasks must be completed sequentially as each builds upon the previous. The dashboard package already exists but needs to be reconfigured from a Node.js/TypeScript library to a React/Vite application. All existing dashboard code will be preserved in a `server/` subdirectory for the future backend implementation (Story 3.3).

- [ ] Task 1: Restructure Dashboard Package for React + Backend (AC: 1)
  - [ ] Move existing `src/index.ts` to `server/index.ts` (preserve for Story 3.3)
  - [ ] Move existing `src/index.test.ts` to `server/index.test.ts`
  - [ ] Create new `src/` directory for React application code
  - [ ] Create `public/` directory for static assets
  - [ ] Update `.gitignore` to include Vite-specific patterns (`dist/`, `.vite/`)
  - [ ] [Source: architecture/source-tree.md#dashboard-package]

- [ ] Task 2: Install and Configure Vite Build Tool (AC: 1, 6, 7)
  - [ ] Install Vite: `npm install --save-dev vite@^5.0.0 --workspace=packages/dashboard`
  - [ ] Install Vite plugins: `npm install --save-dev @vitejs/plugin-react@^4.2.0 --workspace=packages/dashboard`
  - [ ] Create `vite.config.ts` in `packages/dashboard/`:
    - [ ] Configure `@vitejs/plugin-react` for JSX transformation
    - [ ] Set `root: './src'` for source directory
    - [ ] Set `build.outDir: '../dist'` for output directory
    - [ ] Enable code splitting with `build.rollupOptions.output.manualChunks`
    - [ ] Configure `build.minify: 'esbuild'` for production optimization
    - [ ] Set `server.port: 3000` for dev server
    - [ ] Enable `server.open: true` to auto-open browser
  - [ ] Update `packages/dashboard/tsconfig.json`:
    - [ ] Set `"jsx": "react-jsx"` (already configured)
    - [ ] Set `"lib": ["ES2022", "DOM", "DOM.Iterable"]` (already configured)
    - [ ] Add `"moduleResolution": "bundler"` for Vite compatibility
    - [ ] Set `"types": ["vite/client"]` for Vite type definitions
  - [ ] Install Vite type definitions: `npm install --save-dev @types/node@^20.11.0 --workspace=packages/dashboard`
  - [ ] [Source: architecture/tech-stack.md#build-tool-frontend]

- [ ] Task 3: Install React and Dependencies (AC: 1)
  - [ ] Install React: `npm install react@^18.2.0 react-dom@^18.2.0 --workspace=packages/dashboard`
  - [ ] Install React types: `npm install --save-dev @types/react@^18.2.0 @types/react-dom@^18.2.0 --workspace=packages/dashboard` (already installed, verify versions)
  - [ ] Install React Router: `npm install react-router-dom@^6.22.0 --workspace=packages/dashboard`
  - [ ] Install React Router types: `npm install --save-dev @types/react-router-dom@^5.3.3 --workspace=packages/dashboard`
  - [ ] Verify all dependencies installed correctly: `npm list --workspace=packages/dashboard`
  - [ ] [Source: architecture/tech-stack.md#frontend-framework]

- [ ] Task 4: Install and Configure TailwindCSS (AC: 2)
  - [ ] Install TailwindCSS: `npm install --save-dev tailwindcss@^3.4.0 postcss@^8.4.0 autoprefixer@^10.4.0 --workspace=packages/dashboard`
  - [ ] Initialize Tailwind config: `npx tailwindcss init -p` (creates `tailwind.config.js` and `postcss.config.js`)
  - [ ] Configure `tailwind.config.js`:
    - [ ] Set `content: ['./index.html', './src/**/*.{js,ts,jsx,tsx}']` for purging
    - [ ] Configure dark mode: `darkMode: 'class'` for manual dark theme control
    - [ ] Extend theme with custom colors for ILP packet types:
      ```javascript
      theme: {
        extend: {
          colors: {
            'ilp-prepare': '#3b82f6', // blue
            'ilp-fulfill': '#10b981', // green
            'ilp-reject': '#ef4444',  // red
          }
        }
      }
      ```
    - [ ] Add minimal technical aesthetic: monospace fonts for technical data
  - [ ] Create `src/index.css` with Tailwind directives:

    ```css
    @tailwind base;
    @tailwind components;
    @tailwind utilities;

    @layer base {
      body {
        @apply bg-gray-900 text-gray-100;
      }
    }
    ```

  - [ ] [Source: architecture/tech-stack.md#ui-styling]

- [ ] Task 5: Create React Application Entry Point (AC: 1, 6)
  - [ ] Create `public/index.html`:
    - [ ] Add `<!DOCTYPE html>` with `<html lang="en">`
    - [ ] Set `<meta charset="UTF-8">` and viewport meta tag
    - [ ] Set `<title>ILP Network Visualizer</title>`
    - [ ] Add `<div id="root"></div>` mount point
    - [ ] Include `<script type="module" src="/src/main.tsx"></script>`
  - [ ] Create `src/main.tsx` (Vite React entry point):
    - [ ] Import React, ReactDOM
    - [ ] Import `./index.css` for Tailwind styles
    - [ ] Import `App` component
    - [ ] Render `<React.StrictMode><App /></React.StrictMode>` to `#root`
    - [ ] Use `ReactDOM.createRoot()` API (React 18)
  - [ ] Create environment type definitions file `src/vite-env.d.ts`:
    - [ ] Add `/// <reference types="vite/client" />`
  - [ ] [Source: architecture/source-tree.md#dashboard-src]

- [ ] Task 6: Create Main App Component with Routing (AC: 3, 4)
  - [ ] Create `src/App.tsx`:
    - [ ] Import BrowserRouter, Routes, Route from react-router-dom
    - [ ] Import Layout component (to be created)
    - [ ] Define router structure with single route for MVP:
      ```tsx
      <BrowserRouter>
        <Routes>
          <Route path="/" element={<Layout />}>
            <Route index element={<DashboardHome />} />
            {/* Future routes: /nodes/:id, /packets/:id, /logs */}
          </Route>
        </Routes>
      </BrowserRouter>
      ```
    - [ ] Export App component as default
  - [ ] Create `src/components/Layout.tsx`:
    - [ ] Define responsive flex layout with header and main content area
    - [ ] Header includes:
      - [ ] App name: "ILP Network Visualizer"
      - [ ] Version from package.json (import version dynamically)
      - [ ] Dark theme styling with Tailwind classes (`bg-gray-800`, `text-white`)
    - [ ] Main content area uses `<Outlet />` from react-router-dom for nested routes
    - [ ] Apply responsive design for 1366x768 to 1920x1080+ resolutions
  - [ ] Create `src/pages/DashboardHome.tsx`:
    - [ ] Placeholder content: "Dashboard content will be implemented in future stories"
    - [ ] Center content with Tailwind flexbox utilities
    - [ ] Display "Welcome to ILP Network Visualizer" message
  - [ ] [Source: architecture/components.md#dashboardui-react-application]

- [ ] Task 7: Update Package.json Scripts (AC: 6)
  - [ ] Modify `packages/dashboard/package.json` scripts:
    - [ ] Update `"dev": "vite"` for development server
    - [ ] Update `"build": "vite build"` for production build
    - [ ] Add `"preview": "vite preview"` for testing production build locally
    - [ ] Keep `"test": "jest"` for unit tests (future use)
    - [ ] Update `"lint": "eslint src --ext .ts,.tsx"` to include JSX files
  - [ ] Update `"main"` field to `"server/index.js"` (preserve backend entry point)
  - [ ] Add `"type": "module"` for ES modules support with Vite
  - [ ] Verify scripts work: `npm run dev --workspace=packages/dashboard`
  - [ ] [Source: architecture/tech-stack.md#build-tool-frontend]

- [ ] Task 8: Configure ESLint for React (AC: 6)
  - [ ] Install ESLint React plugins: `npm install --save-dev eslint-plugin-react@^7.33.0 eslint-plugin-react-hooks@^4.6.0 --workspace=packages/dashboard`
  - [ ] Create `.eslintrc.json` in `packages/dashboard/`:
    - [ ] Extend `@typescript-eslint/recommended` and `plugin:react/recommended`
    - [ ] Add `plugin:react-hooks/recommended` for hooks linting
    - [ ] Set `parserOptions.ecmaFeatures.jsx: true`
    - [ ] Configure `settings.react.version: "detect"` for auto-detection
    - [ ] Add rules: `"react/react-in-jsx-scope": "off"` (not needed with React 18 JSX transform)
  - [ ] Run lint to verify: `npm run lint --workspace=packages/dashboard`
  - [ ] [Source: architecture/coding-standards.md#core-standards]

- [ ] Task 9: Create Dashboard Dockerfile (AC: 8)
  - [ ] Create `packages/dashboard/Dockerfile`:
    - [ ] Use multi-stage build: builder stage + runtime stage
    - [ ] **Builder stage:**
      - [ ] `FROM node:20-alpine AS builder`
      - [ ] Set `WORKDIR /app`
      - [ ] Copy root `package.json`, `package-lock.json`
      - [ ] Copy `packages/dashboard/package.json`
      - [ ] Copy `packages/shared/` directory (for type dependencies)
      - [ ] Run `npm install` (install all workspace dependencies)
      - [ ] Copy `packages/dashboard/src/`, `packages/dashboard/public/`, config files
      - [ ] Run `npm run build --workspace=packages/dashboard`
      - [ ] Output: `packages/dashboard/dist/` with production build
    - [ ] **Runtime stage:**
      - [ ] `FROM nginx:alpine` for lightweight static file serving
      - [ ] Copy built files: `COPY --from=builder /app/packages/dashboard/dist /usr/share/nginx/html`
      - [ ] Copy custom nginx config if needed (or use default)
      - [ ] Expose port 80
      - [ ] CMD `["nginx", "-g", "daemon off;"]`
  - [ ] Alternative runtime option: Node.js static server with `serve` package (document in comments)
  - [ ] [Source: architecture/infrastructure-and-deployment.md#deployment-strategy]

- [ ] Task 10: Add Dashboard Service to Docker Compose (AC: 9)
  - [ ] Modify root `docker-compose.yml`:
    - [ ] Add `dashboard` service:
      ```yaml
      dashboard:
        build:
          context: .
          dockerfile: packages/dashboard/Dockerfile
        container_name: ilp-dashboard
        ports:
          - '8080:80' # Map nginx port 80 to host 8080
        restart: unless-stopped
        networks:
          - ilp-network
      ```
    - [ ] Ensure `ilp-network` network is defined (already exists from Story 2.5)
    - [ ] Add health check (optional): `healthcheck` for nginx availability
  - [ ] Verify dashboard builds: `docker-compose build dashboard`
  - [ ] Test dashboard starts: `docker-compose up dashboard`
  - [ ] Verify accessible at http://localhost:8080
  - [ ] [Source: architecture/infrastructure-and-deployment.md#deployment-strategy]

- [ ] Task 11: Update README Documentation (AC: 10)
  - [ ] Add "Dashboard" section to root `README.md`:
    - [ ] **Accessing the Dashboard:**
      - [ ] Start all services: `docker-compose up -d`
      - [ ] Open browser: `http://localhost:8080`
      - [ ] Dashboard displays network visualization (placeholder for now)
    - [ ] **Development Mode:**
      - [ ] Run dev server: `npm run dev --workspace=packages/dashboard`
      - [ ] Access at `http://localhost:3000` with hot reload
      - [ ] Useful for rapid UI development without Docker rebuilds
    - [ ] **Building Dashboard:**
      - [ ] Build production assets: `npm run build --workspace=packages/dashboard`
      - [ ] Output to `packages/dashboard/dist/`
      - [ ] Preview build: `npm run preview --workspace=packages/dashboard`
    - [ ] **Technology Stack:**
      - [ ] React 18.2.x with TypeScript
      - [ ] Vite 5.0.x for build tooling
      - [ ] TailwindCSS 3.4.x for styling
      - [ ] React Router 6.22.x for navigation
  - [ ] Update "Quick Start" section to include dashboard access
  - [ ] Add screenshot placeholder: `docs/images/dashboard-screenshot.png` (future)
  - [ ] [Source: architecture/tech-stack.md]

- [ ] Task 12: Add Unit Tests for React Components (AC: 6)
  - [ ] Update Jest configuration in `packages/dashboard/jest.config.js`:
    - [ ] Add `testEnvironment: 'jsdom'` for React testing (already configured)
    - [ ] Configure module name mapper for CSS: `'\\.css$': 'identity-obj-proxy'`
    - [ ] Set `setupFilesAfterEnv: ['<rootDir>/src/setupTests.ts']` for test utilities
    - [ ] Add transform for TypeScript and JSX: `'^.+\\.tsx?$': 'ts-jest'`
  - [ ] Install React Testing Library: `npm install --save-dev @testing-library/react@^14.0.0 @testing-library/jest-dom@^6.1.0 --workspace=packages/dashboard`
  - [ ] Create `src/setupTests.ts`:
    - [ ] Import `@testing-library/jest-dom` for custom matchers
  - [ ] Create `src/App.test.tsx`:
    - [ ] Test 1: App renders without crashing
      - [ ] Render `<App />` and verify no errors
    - [ ] Test 2: App displays correct page title in header
      - [ ] Render and check for "ILP Network Visualizer"
    - [ ] Test 3: App displays version number from package.json
      - [ ] Verify version string appears in header
  - [ ] Create `src/components/Layout.test.tsx`:
    - [ ] Test 1: Layout renders header with app name
    - [ ] Test 2: Layout renders Outlet for nested routes
    - [ ] Test 3: Layout applies dark theme classes
  - [ ] Run tests: `npm test --workspace=packages/dashboard`
  - [ ] Verify test coverage meets >70% threshold for dashboard package
  - [ ] [Source: architecture/test-strategy-and-standards.md#unit-tests]

## Dev Notes

### Previous Story Insights

**From Story 2.7 (Add Health Checks and Container Monitoring):**
[Source: docs/stories/2.7.story.md]

- Docker Compose orchestration established with health checks for connector services
- All connector containers use `ilp-network` Docker network for communication
- Health endpoints exposed on ports 8080+ for external monitoring
- Dashboard will integrate into same Docker Compose environment

**From Story 2.5 (Docker Compose Multi-Node Network):**
[Source: docs/stories/2.5.story.md]

- Root-level `docker-compose.yml` defines shared `ilp-network` network
- Container naming convention: `ilp-{service-name}`
- Services use `restart: unless-stopped` policy
- Volume mounts for configuration files follow pattern: `./config/{node}.yaml:/app/config.yaml:ro`

### Technical Context

**Dashboard Package Current State:**
[Source: Current file inspection]

The `packages/dashboard/` directory currently exists as a minimal TypeScript package with:

- Basic `package.json` configured for Node.js/TypeScript compilation
- Placeholder `src/index.ts` exporting a `version` constant and empty `main()` function
- Jest configured with `identity-obj-proxy` for CSS mocking (already prepared for React)
- TypeScript config already includes `"jsx": "react-jsx"` and DOM types
- This structure was created in anticipation of the dashboard implementation

**Important:** The existing code should NOT be deleted. Instead, it will be moved to `server/` subdirectory as it represents the future dashboard backend implementation (Story 3.3: Implement Telemetry WebSocket Server).

**React + Vite Architecture:**
[Source: architecture/tech-stack.md#frontend-framework, architecture/tech-stack.md#build-tool-frontend]

Vite was chosen over Create React App (CRA) for the following reasons:

- Lightning-fast HMR (Hot Module Replacement) during development
- Optimized production builds using Rollup with tree-shaking
- Native TypeScript support without additional configuration
- Modern ES modules approach (no webpack complexity)
- Smaller bundle sizes and faster build times

Vite configuration for this project:

- React plugin for JSX transformation and Fast Refresh
- Code splitting strategy: vendor chunks (React, React Router) separate from app code
- Production minification using esbuild (faster than Terser)
- CSS modules support out-of-box (though we'll use TailwindCSS utilities)
- Development server with proxy support (future: proxy API requests to backend)

**TailwindCSS Dark Theme Strategy:**
[Source: architecture/tech-stack.md#ui-styling]

TailwindCSS chosen for:

- Utility-first approach enables rapid prototyping
- Purges unused CSS for small production bundles
- Dark theme implementation via `darkMode: 'class'` strategy
- Custom color palette for ILP packet types (blue/green/red per FR8)

Dark theme configuration:

```javascript
// tailwind.config.js
module.exports = {
  darkMode: 'class', // Enables .dark class on <html> element
  theme: {
    extend: {
      colors: {
        'ilp-prepare': '#3b82f6', // Blue for Prepare packets
        'ilp-fulfill': '#10b981', // Green for Fulfill packets
        'ilp-reject': '#ef4444', // Red for Reject packets
      },
    },
  },
};
```

Default dark theme CSS:

```css
@layer base {
  body {
    @apply bg-gray-900 text-gray-100; /* Dark background, light text */
  }
}
```

**React Router Structure:**
[Source: architecture/components.md#dashboardui-react-application]

React Router 6.22.x provides:

- Data router with loader functions (future use for async data fetching)
- Nested routes with `<Outlet />` component for layout composition
- Type-safe navigation with `useNavigate()` hook
- URL parameter extraction with `useParams()` hook

MVP routing structure (single page for now):

```tsx
<BrowserRouter>
  <Routes>
    <Route path="/" element={<Layout />}>
      <Route index element={<DashboardHome />} />
      {/* Future routes (Story 3.6, 3.7):
        - /packets/:id (packet detail inspection)
        - /nodes/:id (node status inspection)
        - /logs (log viewer)
      */}
    </Route>
  </Routes>
</BrowserRouter>
```

Layout component provides:

- Persistent header with app name and version across all pages
- Main content area using `<Outlet />` for nested route rendering
- Responsive container with max-width constraints for large screens
- Dark theme styling consistent with TailwindCSS configuration

**Dockerfile Multi-Stage Build Strategy:**
[Source: architecture/infrastructure-and-deployment.md#deployment-strategy]

Multi-stage build reduces final image size:

1. **Builder stage (node:20-alpine):**
   - Installs all dev dependencies (TypeScript, Vite, etc.)
   - Compiles TypeScript and bundles React app with Vite
   - Produces static files in `dist/` directory

2. **Runtime stage (nginx:alpine):**
   - Copies only static build artifacts from builder stage
   - No Node.js runtime needed (static files only)
   - nginx serves files with optimized caching headers
   - Final image size: ~25MB (nginx + static files)

Alternative: Node.js static server with `serve` package

- If nginx feels like overkill, can use `serve` npm package
- Simpler configuration but larger image (~150MB with Node.js)
- Trade-off: nginx is production-grade, `serve` is simpler

**Docker Compose Integration:**
[Source: architecture/infrastructure-and-deployment.md#deployment-strategy]

Dashboard service configuration:

```yaml
dashboard:
  build:
    context: . # Root directory (for workspace deps)
    dockerfile: packages/dashboard/Dockerfile # Dashboard-specific Dockerfile
  container_name: ilp-dashboard # Consistent naming
  ports:
    - '8080:80' # nginx port 80 → host 8080
  networks:
    - ilp-network # Shared network with connectors
  restart: unless-stopped # Auto-restart on failure
```

Port allocation rationale:

- Dashboard: 8080 (HTTP, user-facing)
- Connector health checks: 8080-8082 (one per connector)
- **CONFLICT:** Dashboard and connector-a both use 8080
- **RESOLUTION:** Move connector health ports to 9080-9082, reserve 8080 for dashboard

**Responsive Design Requirements:**
[Source: Story AC#5]

Target resolutions:

- Minimum: 1366x768 (common laptop resolution)
- Optimal: 1920x1080 (standard desktop)
- Maximum: 2560x1440+ (large monitors)

Layout constraints:

- Header: Fixed height (~64px), full width
- Main content: Flexible height (viewport minus header)
- Network graph: Scales to fill available space
- Side panels: Fixed width (~400px), slide in from right
- Responsive breakpoints: Use Tailwind's `md:`, `lg:`, `xl:` classes

**Version Display Strategy:**

Dashboard header displays version from `package.json`:

```tsx
import packageJson from '../package.json';

function Layout() {
  return (
    <header>
      <h1>ILP Network Visualizer</h1>
      <span className="text-sm text-gray-400">v{packageJson.version}</span>
    </header>
  );
}
```

TypeScript configuration requirement:

- Must enable `resolveJsonModule: true` in `tsconfig.json`
- Allows importing JSON files with type safety
- Version automatically stays in sync with package.json

### File Locations and Project Structure

**New Files to Create:**

React Application:

- `packages/dashboard/public/index.html` - HTML entry point with `#root` mount
- `packages/dashboard/src/main.tsx` - React 18 app entry point, Vite module script
- `packages/dashboard/src/vite-env.d.ts` - Vite environment type definitions
- `packages/dashboard/src/App.tsx` - Main app component with router configuration
- `packages/dashboard/src/index.css` - Tailwind CSS imports and base styles
- `packages/dashboard/src/components/Layout.tsx` - Header + content layout component
- `packages/dashboard/src/pages/DashboardHome.tsx` - Placeholder home page

Configuration Files:

- `packages/dashboard/vite.config.ts` - Vite build tool configuration
- `packages/dashboard/tailwind.config.js` - TailwindCSS customization
- `packages/dashboard/postcss.config.js` - PostCSS with Tailwind and Autoprefixer
- `packages/dashboard/.eslintrc.json` - React-specific ESLint rules

Testing:

- `packages/dashboard/src/setupTests.ts` - Jest + React Testing Library setup
- `packages/dashboard/src/App.test.tsx` - Unit tests for App component
- `packages/dashboard/src/components/Layout.test.tsx` - Layout component tests

Docker:

- `packages/dashboard/Dockerfile` - Multi-stage build: Node.js builder + nginx runtime

**Files to Modify:**

- `packages/dashboard/package.json` - Update scripts, add Vite/React/Tailwind dependencies
- `packages/dashboard/tsconfig.json` - Add `moduleResolution: bundler`, `resolveJsonModule: true`
- `docker-compose.yml` - Add dashboard service, adjust connector health ports to avoid conflicts
- `README.md` - Add Dashboard section with access instructions and tech stack info

**Files to Move (Preserve Backend Code):**

- `packages/dashboard/src/index.ts` → `packages/dashboard/server/index.ts`
- `packages/dashboard/src/index.test.ts` → `packages/dashboard/server/index.test.ts`

**Project Structure After This Story:**

```
packages/dashboard/
├── server/                      # Backend code (preserved for Story 3.3)
│   ├── index.ts                 # Placeholder backend entry point
│   └── index.test.ts            # Backend tests
├── src/                         # React UI source (NEW)
│   ├── components/
│   │   ├── Layout.tsx           # Main layout component
│   │   └── Layout.test.tsx      # Layout tests
│   ├── pages/
│   │   └── DashboardHome.tsx    # Home page placeholder
│   ├── App.tsx                  # Root app with router
│   ├── App.test.tsx             # App tests
│   ├── main.tsx                 # Vite entry point
│   ├── index.css                # Tailwind CSS
│   ├── vite-env.d.ts            # Vite types
│   └── setupTests.ts            # Jest setup
├── public/
│   └── index.html               # HTML template
├── dist/                        # Build output (gitignored)
├── Dockerfile                   # Multi-stage build
├── package.json                 # Updated with Vite/React deps
├── tsconfig.json                # Updated for Vite
├── vite.config.ts               # Vite configuration
├── tailwind.config.js           # Tailwind customization
├── postcss.config.js            # PostCSS config
├── .eslintrc.json               # React ESLint rules
└── jest.config.js               # Jest config (existing)
```

### Data Models Relevant to This Story

**No ILP-specific data models used in this story.** This story establishes the React application scaffold only. Future stories (3.2-3.7) will introduce:

- `TelemetryEvent` types (Story 3.3)
- `NetworkNode` and `NetworkEdge` types for graph visualization (Story 3.2)
- `PacketFlowAnimation` types (Story 3.5)

For this story, the only "data" is:

- Static app metadata: name ("ILP Network Visualizer"), version (from package.json)
- Placeholder content for home page

### Testing Strategy for This Story

**Unit Test Coverage (>70% target for dashboard):**
[Source: architecture/test-strategy-and-standards.md#unit-tests]

React Testing Library approach:

- Focus on user-facing behavior, not implementation details
- Query elements by accessible roles and labels (not test IDs)
- Simulate user interactions (future stories: clicks, inputs)
- Verify rendered output matches expectations

App Component Tests:

- ✓ Renders without errors (smoke test)
- ✓ Displays app name in header
- ✓ Displays correct version from package.json
- ✓ Renders router with home page as default route

Layout Component Tests:

- ✓ Renders header with app name "ILP Network Visualizer"
- ✓ Renders version number in header
- ✓ Renders Outlet component for nested routes
- ✓ Applies dark theme classes (bg-gray-800, text-white)
- ✓ Header has fixed positioning (CSS class verification)

DashboardHome Component Tests:

- ✓ Renders placeholder welcome message
- ✓ Message centered with Tailwind flex utilities

**Integration Tests (Deferred to Story 3.3):**

End-to-end dashboard testing will be implemented in Story 3.3 when the telemetry backend is available. Integration tests will verify:

- Dashboard UI connects to telemetry WebSocket server
- Telemetry events update UI state in real-time
- Network graph renders based on connector topology

**Manual Testing Scenarios:**

1. **Development Server Hot Reload:**

   ```bash
   npm run dev --workspace=packages/dashboard
   # Open http://localhost:3000
   # Modify src/components/Layout.tsx (change app name)
   # Verify browser auto-updates without refresh
   ```

2. **Production Build and Preview:**

   ```bash
   npm run build --workspace=packages/dashboard
   # Verify dist/ directory created with optimized assets
   # Check bundle sizes: main.[hash].js, vendor.[hash].js
   npm run preview --workspace=packages/dashboard
   # Open http://localhost:4173
   # Verify minified app loads correctly
   ```

3. **Docker Build and Deployment:**

   ```bash
   docker-compose build dashboard
   # Verify build completes without errors
   docker-compose up dashboard
   # Open http://localhost:8080
   # Verify dashboard displays correctly
   # Check nginx logs: docker-compose logs dashboard
   ```

4. **Responsive Layout Testing:**

   ```bash
   npm run dev --workspace=packages/dashboard
   # Open browser dev tools
   # Test resolutions: 1366x768, 1920x1080, 2560x1440
   # Verify header and content scale appropriately
   # Verify no horizontal scrolling at any resolution
   ```

5. **Dark Theme Verification:**
   ```bash
   # Inspect rendered HTML in browser
   # Verify <body> has bg-gray-900 and text-gray-100 classes
   # Verify header has bg-gray-800 background
   # Check all text readable against dark backgrounds
   ```

### Definition of Done Checklist

- [ ] Dashboard package restructured: backend code moved to `server/`, React code in `src/`
- [ ] Vite 5.0.x installed and configured with React plugin
- [ ] `vite.config.ts` includes code splitting and minification settings
- [ ] React 18.2.x and React Router 6.22.x installed
- [ ] TailwindCSS 3.4.x installed and configured with dark theme
- [ ] `tailwind.config.js` includes custom ILP packet colors
- [ ] `src/index.css` applies dark theme base styles
- [ ] `public/index.html` created with root mount point
- [ ] `src/main.tsx` renders app with React 18 createRoot API
- [ ] `src/App.tsx` configures router with layout and home page
- [ ] `src/components/Layout.tsx` renders header with app name and version
- [ ] `src/pages/DashboardHome.tsx` displays placeholder content
- [ ] `package.json` scripts updated: `dev`, `build`, `preview` work correctly
- [ ] ESLint configured for React with `eslint-plugin-react` and `eslint-plugin-react-hooks`
- [ ] TypeScript compiles: `npm run build --workspace=packages/dashboard`
- [ ] ESLint passes: `npm run lint --workspace=packages/dashboard`
- [ ] Development server runs: `npm run dev --workspace=packages/dashboard`
- [ ] Hot module replacement works (modify file, browser updates)
- [ ] Production build optimized: bundle sizes < 200KB (gzipped), code splitting active
- [ ] Dashboard Dockerfile created with multi-stage build (node builder + nginx runtime)
- [ ] Docker image builds successfully: `docker-compose build dashboard`
- [ ] Dashboard service added to `docker-compose.yml` on port 8080
- [ ] Connector health check ports moved to 9080-9082 to avoid port conflict
- [ ] Dashboard accessible at http://localhost:8080 when deployed via Docker
- [ ] README updated with Dashboard section, development instructions, and tech stack
- [ ] React Testing Library installed for component testing
- [ ] `src/setupTests.ts` configures Jest with jsdom and @testing-library/jest-dom
- [ ] Unit tests created: App.test.tsx, Layout.test.tsx
- [ ] All unit tests passing: `npm test --workspace=packages/dashboard`
- [ ] Test coverage >70% for dashboard package
- [ ] Responsive layout verified at 1366x768, 1920x1080, 2560x1440 resolutions
- [ ] Dark theme applied correctly: dark backgrounds, light text, readable contrast

## Testing

### Test Execution Commands

**Unit Tests:**

```bash
# Run all dashboard unit tests
npm test --workspace=packages/dashboard

# Run tests in watch mode (during development)
npm run test:watch --workspace=packages/dashboard

# Run tests with coverage report
npm run test:coverage --workspace=packages/dashboard

# Coverage threshold: >70% for dashboard package
```

**Build Verification:**

```bash
# Verify TypeScript compilation
npm run build --workspace=packages/dashboard

# Check for TypeScript errors (no build output)
npx tsc --noEmit --project packages/dashboard

# Lint check
npm run lint --workspace=packages/dashboard
```

**Development Server:**

```bash
# Start Vite dev server with hot reload
npm run dev --workspace=packages/dashboard
# Access at http://localhost:3000

# Preview production build locally
npm run build --workspace=packages/dashboard
npm run preview --workspace=packages/dashboard
# Access at http://localhost:4173
```

**Docker Deployment:**

```bash
# Build dashboard Docker image
docker-compose build dashboard

# Start dashboard service
docker-compose up dashboard
# Access at http://localhost:8080

# View dashboard logs
docker-compose logs -f dashboard

# Stop dashboard
docker-compose down
```

### Expected Test Results

**Before Story Completion:**

- Dashboard package has minimal placeholder code
- No React dependencies installed
- `npm run dev` fails (no Vite configuration)
- `npm run build` produces Node.js compiled output (not React bundle)
- Docker Compose has no dashboard service

**After Story Completion:**

- React 18 application renders in browser
- Development server starts at http://localhost:3000 with hot reload
- Production build creates optimized bundles in `dist/`:
  - `index.html` (entry point)
  - `assets/main.[hash].js` (app code, ~50KB gzipped)
  - `assets/vendor.[hash].js` (React + Router, ~150KB gzipped)
  - `assets/index.[hash].css` (Tailwind CSS, ~10KB gzipped)
- Dashboard displays header with "ILP Network Visualizer" and version number
- Dark theme applied: dark gray background, light text
- Layout responsive across target resolutions (1366x768 to 2560x1440)
- Docker container builds successfully and serves app via nginx on port 8080
- All unit tests pass with >70% coverage
- ESLint and TypeScript validation pass with no errors

### Manual Testing Scenarios

**Scenario 1: Development Workflow with Hot Reload**

```bash
# Start dev server
npm run dev --workspace=packages/dashboard

# Expected: Vite dev server starts on http://localhost:3000
# Browser opens automatically (if configured)
# Dashboard displays with header and placeholder content

# Modify src/components/Layout.tsx - change "ILP Network Visualizer" to "ILP Dashboard"
# Expected: Browser updates instantly without full page refresh
# New app name appears in header

# Modify src/index.css - change bg-gray-900 to bg-blue-900
# Expected: Background color changes to blue immediately
# CSS hot reloads without losing component state
```

**Scenario 2: Production Build Optimization Verification**

```bash
# Build production bundle
npm run build --workspace=packages/dashboard

# Expected output:
# vite v5.0.x building for production...
# ✓ 15 modules transformed.
# dist/index.html                   0.45 kB
# dist/assets/index-[hash].css      10.2 kB │ gzip: 2.5 kB
# dist/assets/main-[hash].js        55.3 kB │ gzip: 18.1 kB
# dist/assets/vendor-[hash].js     145.2 kB │ gzip: 46.3 kB
# ✓ built in 2.3s

# Verify code splitting: 3 separate JS files (index.html, main, vendor)
ls -lh packages/dashboard/dist/assets/

# Preview production build
npm run preview --workspace=packages/dashboard
# Open http://localhost:4173
# Verify app loads and functions identically to dev mode
```

**Scenario 3: Docker Build and Deployment**

```bash
# Build Docker image
docker-compose build dashboard

# Expected: Multi-stage build completes
# Step 1: node:20-alpine builder stage installs deps and builds React app
# Step 2: nginx:alpine copies static files from builder
# Final image size: ~25MB (nginx + static assets)

# Start dashboard container
docker-compose up dashboard

# Expected logs:
# ilp-dashboard | /docker-entrypoint.sh: Configuration complete; ready for start up
# ilp-dashboard | 2025/12/27 10:00:00 [notice] nginx started

# Open http://localhost:8080
# Verify dashboard loads correctly
# Inspect page source: verify minified JS and CSS files
# Check browser Network tab: verify static files served with correct MIME types

# Test nginx error handling
curl -I http://localhost:8080/nonexistent
# Expected: HTTP/1.1 404 Not Found

# Stop dashboard
docker-compose down
```

**Scenario 4: Responsive Layout Verification**

```bash
# Start dev server
npm run dev --workspace=packages/dashboard

# Open browser dev tools (F12)
# Select responsive design mode (Ctrl+Shift+M)

# Test 1366x768 resolution:
# - Verify header spans full width
# - Verify content centered with padding
# - Verify no horizontal scrollbar

# Test 1920x1080 resolution:
# - Verify layout scales appropriately
# - Verify max-width constraint on content (if any)
# - Verify header and content properly aligned

# Test 2560x1440 resolution:
# - Verify content doesn't stretch too wide (max-width applied)
# - Verify text remains readable (not too far from edges)

# Test mobile resolution (768x1024 - out of spec but verify graceful degradation):
# - Verify header remains visible
# - Verify content doesn't break layout
# - Note: Mobile optimization not required for MVP, but should not crash
```

**Scenario 5: Dark Theme Verification**

```bash
# Start dashboard (dev or Docker)
npm run dev --workspace=packages/dashboard

# Open browser dev tools > Elements
# Inspect <body> element
# Verify classes: bg-gray-900 text-gray-100

# Inspect header element
# Verify classes: bg-gray-800 (or similar dark gray)

# Inspect text elements
# Verify all text has sufficient contrast against dark background
# Use browser accessibility tools to check contrast ratio (WCAG AA: 4.5:1 minimum)

# Verify custom colors defined in Tailwind:
# - ilp-prepare: #3b82f6 (blue) - not used yet, but available
# - ilp-fulfill: #10b981 (green)
# - ilp-reject: #ef4444 (red)
# Check browser dev tools > Computed styles to verify CSS variables or classes
```

**Scenario 6: Router Navigation (Future-Proofing)**

```bash
# Start dev server
npm run dev --workspace=packages/dashboard

# Open http://localhost:3000/
# Expected: Home page displays with placeholder content

# Manually navigate to http://localhost:3000/nonexistent
# Expected: 404 fallback (or home page if no 404 route defined yet)

# Verify React Router is active:
# - Open browser console
# - No errors about missing router context
# - React DevTools shows <BrowserRouter> component in tree
```

## Dev Agent Record

### Agent Model Used

- (To be filled in by Dev Agent during implementation)

### Debug Log References

- (To be filled in by Dev Agent during implementation)

### Completion Notes

- (To be filled in by Dev Agent during implementation)

### File List

**New Files:**

- (To be filled in by Dev Agent during implementation)

**Modified Files:**

- (To be filled in by Dev Agent during implementation)

## QA Review Summary

- (To be filled in by QA Agent after implementation)

## Change Log

| Date       | Version | Description                                                                     | Author     |
| ---------- | ------- | ------------------------------------------------------------------------------- | ---------- |
| 2025-12-27 | 1.0     | Initial story draft with comprehensive technical context from architecture docs | BMAD Agent |
