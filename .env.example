# =============================================================================
# M2M Connector Production Configuration
# =============================================================================
# Copy this file to .env and fill in your values.
# NEVER commit .env to version control!
# =============================================================================
#
# ⚠️  CRITICAL SECURITY WARNING - PRODUCTION DEPLOYMENTS (Story 16.2)
# =============================================================================
# The default settings below are FOR DEVELOPMENT ONLY and MUST NOT be used
# in production environments. Production deployments require:
#
# 1. KEY_BACKEND must use KMS (aws-kms, gcp-kms, azure-keyvault), NOT 'env'
#    → Storing cryptographic keys in environment variables is INSECURE
#
# 2. GRAFANA_PASSWORD must be changed from default 'admin'
#    → Default credentials are a CRITICAL SECURITY RISK
#
# 3. All secrets must be injected via secure secret management systems
#    → DO NOT store production secrets in .env files
#
# Before deploying to production, run the preflight validation script:
#   ./scripts/production-preflight.sh
#
# This script will validate your configuration and block deployment if
# insecure settings are detected.
# =============================================================================

# -----------------------------------------------------------------------------
# REQUIRED: Core Configuration
# -----------------------------------------------------------------------------

# Unique identifier for this connector node
NODE_ID=my-connector

# Settlement preference: 'evm' | 'xrp' | 'both'
SETTLEMENT_PREFERENCE=both

# -----------------------------------------------------------------------------
# REQUIRED: Blockchain Configuration (based on settlement preference)
# -----------------------------------------------------------------------------

# Base L2 RPC endpoint (required if SETTLEMENT_PREFERENCE includes 'evm')
# Mainnet: https://mainnet.base.org
# Sepolia: https://sepolia.base.org
BASE_RPC_URL=https://mainnet.base.org

# XRP Ledger WebSocket URL (required if SETTLEMENT_PREFERENCE includes 'xrp')
# Mainnet: wss://xrplcluster.com or wss://s1.ripple.com
# Testnet: wss://s.altnet.rippletest.net
XRPL_WSS_URL=wss://xrplcluster.com

# Ethereum address for EVM settlement (required if SETTLEMENT_PREFERENCE includes 'evm')
# Must be a valid 0x-prefixed address
EVM_ADDRESS=

# XRP address for XRP settlement (required if SETTLEMENT_PREFERENCE includes 'xrp')
# Must be a valid r-prefixed address
XRP_ADDRESS=

# -----------------------------------------------------------------------------
# REQUIRED: Key Management
# -----------------------------------------------------------------------------

# Key management backend: 'env' | 'aws-kms' | 'gcp-kms' | 'azure-kv'
# ⚠️  SECURITY WARNING (Story 16.2):
#    KEY_BACKEND=env is INSECURE for production - use KMS in production!
#    Production preflight validation WILL BLOCK deployment if KEY_BACKEND=env
#    Valid production options: aws-kms | gcp-kms | azure-keyvault
KEY_BACKEND=env  # ⚠️ DEV ONLY - Use KMS for production

# For KEY_BACKEND=env only (DEVELOPMENT ONLY - NOT FOR PRODUCTION):
# EVM_PRIVATE_KEY=0x...
# XRP_SEED=s...

# For KEY_BACKEND=aws-kms:
# AWS_REGION=us-east-1
# AWS_KMS_EVM_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/...
# AWS_KMS_XRP_KEY_ID=arn:aws:kms:us-east-1:123456789012:key/...

# For KEY_BACKEND=gcp-kms:
# GCP_PROJECT_ID=my-project
# GCP_LOCATION_ID=us-east1
# GCP_KEY_RING_ID=my-keyring
# GCP_KMS_EVM_KEY_ID=evm-signing-key
# GCP_KMS_XRP_KEY_ID=xrp-signing-key

# For KEY_BACKEND=azure-kv:
# AZURE_VAULT_URL=https://my-vault.vault.azure.net
# AZURE_EVM_KEY_NAME=evm-signing-key
# AZURE_XRP_KEY_NAME=xrp-signing-key

# -----------------------------------------------------------------------------
# OPTIONAL: Network Configuration
# -----------------------------------------------------------------------------

# BTP server port (default: 4000)
BTP_PORT=4000

# Health check and metrics HTTP port (default: 8080)
HEALTH_CHECK_PORT=8080

# -----------------------------------------------------------------------------
# OPTIONAL: Monitoring Configuration
# -----------------------------------------------------------------------------

# Enable Prometheus metrics (default: true)
PROMETHEUS_ENABLED=true

# Grafana admin password
# ⚠️  SECURITY WARNING (Story 16.2):
#    Default password 'admin' is a CRITICAL SECURITY RISK in production!
#    Production preflight validation WILL BLOCK deployment if password=admin
#    Use a strong password: minimum 16 characters, mixed case, numbers, symbols
GRAFANA_PASSWORD=admin  # ⚠️ DEV ONLY - Change for production

# OpenTelemetry OTLP endpoint for distributed tracing (optional)
# OTEL_EXPORTER_OTLP_ENDPOINT=http://jaeger:4318

# -----------------------------------------------------------------------------
# OPTIONAL: Logging Configuration
# -----------------------------------------------------------------------------

# Log level: 'debug' | 'info' | 'warn' | 'error' (default: info)
LOG_LEVEL=info

# -----------------------------------------------------------------------------
# OPTIONAL: Peer Discovery
# -----------------------------------------------------------------------------

# Enable automatic peer discovery (default: false)
PEER_DISCOVERY_ENABLED=false

# Discovery service endpoints (comma-separated)
# PEER_DISCOVERY_ENDPOINTS=http://discovery.example.com:9999

# Public address to announce (auto-detected if not set)
# PEER_ANNOUNCE_ADDRESS=ws://my-connector.example.com:4000

# -----------------------------------------------------------------------------
# OPTIONAL: TigerBeetle Configuration
# -----------------------------------------------------------------------------

# TigerBeetle cluster ID (default: 0)
TIGERBEETLE_CLUSTER_ID=0

# TigerBeetle replica addresses (default: tigerbeetle:3000 for Docker)
TIGERBEETLE_REPLICAS=tigerbeetle:3000

# -----------------------------------------------------------------------------
# DEVELOPMENT ONLY: Private Keys (DO NOT USE IN PRODUCTION)
# -----------------------------------------------------------------------------
# These are ONLY for local development. In production, use KMS backends.
# Generate secure keys: openssl rand -hex 32 (for EVM)

# EVM private key (hex format with 0x prefix)
# EVM_PRIVATE_KEY=0x...

# XRP seed (XRPL seed format starting with 's')
# XRP_SEED=s...

# -----------------------------------------------------------------------------
# AWS KMS Configuration (when KEY_BACKEND=aws-kms)
# -----------------------------------------------------------------------------

# AWS region where KMS keys are located
AWS_REGION=us-east-1

# AWS KMS key IDs (ARN, alias, or key ID format)
# ARN format: arn:aws:kms:region:account-id:key/key-id
AWS_KMS_EVM_KEY_ID=
AWS_KMS_XRP_KEY_ID=

# AWS credentials (optional - uses IAM role/instance profile if not provided)
# AWS_ACCESS_KEY_ID=AKIAIOSFODNN7EXAMPLE
# AWS_SECRET_ACCESS_KEY=wJalrXUtnFEMI/K7MDENG/bPxRfiCYEXAMPLEKEY

# -----------------------------------------------------------------------------
# GCP KMS Configuration (when KEY_BACKEND=gcp-kms)
# -----------------------------------------------------------------------------

# GCP project ID
GCP_PROJECT_ID=

# GCP KMS location (e.g., 'us-east1', 'global')
GCP_LOCATION_ID=us-east1

# GCP KMS key ring name
GCP_KEY_RING_ID=connector-keyring

# GCP KMS crypto key names
GCP_KMS_EVM_KEY_ID=evm-signing-key
GCP_KMS_XRP_KEY_ID=xrp-signing-key

# -----------------------------------------------------------------------------
# Azure Key Vault Configuration (when KEY_BACKEND=azure-kv)
# -----------------------------------------------------------------------------

# Azure Key Vault URL
# Format: https://<vault-name>.vault.azure.net/
AZURE_VAULT_URL=

# Azure Key Vault key names
AZURE_EVM_KEY_NAME=evm-signing-key
AZURE_XRP_KEY_NAME=xrp-signing-key

# Azure service principal credentials (optional - uses DefaultAzureCredential)
# AZURE_TENANT_ID=00000000-0000-0000-0000-000000000000
# AZURE_CLIENT_ID=00000000-0000-0000-0000-000000000000
# AZURE_CLIENT_SECRET=your-client-secret

# -----------------------------------------------------------------------------
# BTP Peer Authentication (if using authenticated peers)
# -----------------------------------------------------------------------------
# Pattern: BTP_PEER_<PEER_ID_UPPERCASE>_SECRET=<secret_value>
# Generate secrets: openssl rand -base64 32
# Example:
# BTP_PEER_ALICE_SECRET=your-shared-secret-with-alice
# BTP_PEER_BOB_SECRET=your-shared-secret-with-bob

# -----------------------------------------------------------------------------
# OPTIONAL: Multi-Hop Peer Addresses (for 5-peer deployment)
# -----------------------------------------------------------------------------
# Pre-generated Ethereum addresses for multi-hop test deployment.
# If not provided, the funding script will generate new wallets.
# 
# Generate addresses with:
#   cast wallet new
# Or let the funding script auto-generate them.

# PEER1_EVM_ADDRESS=0x...
# PEER2_EVM_ADDRESS=0x...
# PEER3_EVM_ADDRESS=0x...
# PEER4_EVM_ADDRESS=0x...
# PEER5_EVM_ADDRESS=0x...

# -----------------------------------------------------------------------------
# OPTIONAL: Multi-Hop BTP Authentication Secrets
# -----------------------------------------------------------------------------
# Shared secrets for BTP connections between peers in multi-hop topology.
# These are used by the 5-peer deployment (docker-compose-5-peer-multihop.yml).

# BTP_PEER_PEER1_SECRET=secret-peer1-to-peer2
# BTP_PEER_PEER2_SECRET=secret-peer2-to-peer3
# BTP_PEER_PEER3_SECRET=secret-peer3-to-peer4
# BTP_PEER_PEER4_SECRET=secret-peer4-to-peer5
# BTP_PEER_SEND_PACKET_CLIENT_SECRET=test-token
