# Agent Society Protocol Configuration
# This file configures an autonomous agent for ILP+Nostr communication
#
# Configuration Reference:
# - See docs/prd/epic-13-agent-society-protocol.md for full specification
# - All pricing values are in smallest unit (e.g., drops for XRP)

# =============================================================================
# Agent Identity Configuration (AC: 1)
# =============================================================================
# Choose ONE of the following options for agent identity:
#
# Option 1: Direct private key (DEVELOPMENT ONLY - NEVER commit to version control!)
# Option 2: Key file path (recommended for production)
#
agent:
  # Option 1: Direct private key (development only - NEVER commit this!)
  # privateKey: "your-64-character-hex-private-key-here"

  # Option 2: Key file path (recommended for production)
  # Supports multiple formats:
  # - Raw hex (64 characters)
  # - nsec (Nostr secret key bech32 format, starts with "nsec1")
  # - Encrypted file (AES-256-GCM) - set AGENT_KEY_PASSWORD env var
  keyFilePath: "./data/agent-key.enc"

  # Public key (optional - automatically derived from private key if omitted)
  # Explicitly setting this can speed up startup by skipping derivation
  # publicKey: "your-64-character-hex-public-key-here"

# =============================================================================
# Database Configuration (AC: 2)
# =============================================================================
# libSQL database for Nostr event storage
#
database:
  # Database path - supported formats:
  # - "file:./data/events.db" - file-based database (persistent)
  # - ":memory:" - in-memory database (lost on restart, for testing)
  path: "file:./data/events.db"

  # Maximum database size in bytes
  # Default: 104857600 (100MB)
  # Set to 0 for unlimited (not recommended for production)
  maxSizeBytes: 104857600

# =============================================================================
# Pricing Configuration (AC: 3)
# =============================================================================
# Service costs in smallest unit (e.g., drops for XRP, wei for ETH)
# All values are strings to support large numbers (bigint)
#
pricing:
  # Kind 1: Cost to store a text note
  noteStorage: "100"

  # Kind 3: Cost for follow list update
  followUpdate: "50"

  # Kind 5: Cost for event deletion request
  deletion: "10"

  # Kind 10000: Base cost for query execution
  queryBase: "200"

  # Kind 10000: Per-result cost (optional)
  # If omitted, only base cost is charged
  queryPerResult: "10"

# =============================================================================
# Static Follow List (AC: 4)
# =============================================================================
# Agents this node follows and can route payments to.
# These are loaded at startup and create routing table entries.
#
# Each entry requires:
# - pubkey: 64-character hex Nostr public key
# - ilpAddress: Valid ILP address (RFC-0015 format)
# - petname: Optional human-readable name (for logging/debugging)
#
follows:
  # Example: Follow Alice's agent
  - pubkey: "abc123def456789012345678901234567890123456789012345678901234abcd"
    ilpAddress: "g.agent.alice"
    petname: "alice"

  # Example: Follow Bob's query service
  - pubkey: "789xyz012345678901234567890123456789012345678901234567890123efgh"
    ilpAddress: "g.agent.bob.query"
    petname: "bob-query"

  # Example: Follow a relay aggregator
  # - pubkey: "fedcba9876543210fedcba9876543210fedcba9876543210fedcba987654ijkl"
  #   ilpAddress: "g.relay.aggregator"
  #   petname: "relay-agg"

# =============================================================================
# Handler Configuration (AC: 5)
# =============================================================================
# Enable or disable specific event kind handlers.
# All handlers are enabled by default when this section is omitted.
#
handlers:
  # Kind 1: Text note storage
  enableNoteHandler: true

  # Kind 3: Follow list updates (updates routing table)
  enableFollowHandler: true

  # Kind 5: Event deletion requests
  enableDeleteHandler: true

  # Kind 10000: Query requests
  enableQueryHandler: true

# =============================================================================
# Subscription Settings
# =============================================================================
# Configure subscription limits for real-time event delivery
#
subscriptions:
  # Maximum subscriptions per peer connection
  # Default: 10
  # Higher values increase memory usage but allow more concurrent filters
  maxPerPeer: 10

# =============================================================================
# Environment Variables
# =============================================================================
# The following environment variables can override or supplement this config:
#
# AGENT_PRIVATE_KEY     - Nostr private key (overrides keyFilePath)
# AGENT_KEY_PASSWORD    - Password for encrypted key files
# AGENT_DATABASE_PATH   - Override database.path
# AGENT_DATABASE_MAX_SIZE - Override database.maxSizeBytes
#
# Pricing (override pricing section):
# AGENT_PRICING_NOTE_STORAGE
# AGENT_PRICING_FOLLOW_UPDATE
# AGENT_PRICING_DELETION
# AGENT_PRICING_QUERY_BASE
# AGENT_PRICING_QUERY_PER_RESULT
#
# AGENT_MAX_SUBSCRIPTIONS_PER_PEER - Override subscriptions.maxPerPeer
