# Multi-Hop Topology: Peer 4 (Transit Node 3)
# Topology: Peer1 ← Peer2 ← Peer3 ← Peer4 → Peer5
#
# This is the third transit node in the multi-hop chain.
# Peer4 connects to both Peer3 (upstream) and Peer5 (downstream).
#
# Network Flow:
# - Receives packets from Peer3 and Peer5
# - Forwards packets destined for Peer1/2/3 upstream to Peer3
# - Forwards packets destined for Peer5 downstream to Peer5

# Node Identity
nodeId: peer4
ilpAddress: g.peer4
btpServerPort: 3003
explorerPort: 5176
logLevel: info

# Optional Configuration
healthCheckPort: 8080

# Peer Connections
# Peer4 initiates BTP connections to both Peer3 (upstream) and Peer5 (downstream)
peers:
  - id: peer3
    url: ws://peer3:3002
    authToken: secret-peer3-to-peer4

  - id: peer5
    url: ws://peer5:3004
    authToken: secret-peer4-to-peer5

# Routing Table
# Route traffic upstream to Peer1/2/3, downstream to Peer5
routes:
  # Route to peer1 (via peer3)
  - prefix: g.peer1
    nextHop: peer3
    priority: 0

  # Route to peer2 (via peer3)
  - prefix: g.peer2
    nextHop: peer3
    priority: 0

  # Route to peer3 (upstream)
  - prefix: g.peer3
    nextHop: peer3
    priority: 0

  # Local delivery for g.peer4 destinations
  - prefix: g.peer4
    nextHop: peer4
    priority: 0

  # Route to peer5 (downstream)
  - prefix: g.peer5
    nextHop: peer5
    priority: 0

# Settlement Configuration (Payment Channels)
# Peer4 uses both Aptos (for Peer3) and EVM (for Peer5)
settlement:
  connectorFeePercentage: 0.1
  enableSettlement: true
  settlementThreshold: 1000000
  initialDepositMultiplier: 10

  # TigerBeetle Configuration
  tigerBeetleClusterId: 0
  tigerBeetleReplicas:
    - tigerbeetle-5peer:3000

# Settlement preference: 'both' to support Aptos and EVM
settlementPreference: both
